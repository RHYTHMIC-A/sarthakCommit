"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function isApiObject(e) {
    return e && typeof e.end === 'function';
}
exports.isApiObject = isApiObject;
function isApiError(e) {
    return e && typeof e.print === 'function';
}
exports.isApiError = isApiError;
/**
 * Custom handler resolver to support promises
 */
exports.step = function (handler) { return function (req, res, next) {
    return Promise.resolve(handler(req, res, next))
        .then(function (result) {
        if (isApiObject(result)) {
            if (isApiError(result)) {
                next(result);
            }
            else {
                result.end();
            }
        }
    })
        .catch(next);
}; };
exports.steps = function (handlers) {
    return handlers.map(exports.step);
};
